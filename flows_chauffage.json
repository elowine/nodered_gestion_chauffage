[{"id":"af8edeeb.a0941","type":"subflow","name":"horaire_chauffage","info":"","category":"","in":[{"x":100,"y":20,"wires":[{"id":"104225fc.f4e25a"}]}],"out":[{"x":420,"y":80,"wires":[{"id":"f626f489.87ba78","port":0}]}],"env":[],"color":"#DDAA99"},{"id":"f626f489.87ba78","type":"function","z":"af8edeeb.a0941","name":"","func":"heure = msg.heure;\nminute = msg.minute; \n//de 5h31 Á� 9     => 21.5\n// entre 6 & 8:59 ou 5 et sup à 30\nif(msg.mode_auto =='off'){\n    msg.tmp1 = \"pas actif\";\n}else if((heure > 5 && heure < 9) || (heure == 5 && minute >=30 )){\n    msg.mode = 21.5;   \n    msg.tmp1 = \"de 5h31 à 9     => 22\";\n}\n//de 9h00 à 11h   => 20   \n// entre 9 et 10:59\nelse if(heure >= 9 & heure <11){\n    msg.mode = 20;\n    msg.tmp1 = \"de 9h00 à 11h   => 20\";\n}\n//de 11h00 à 13h30  => 21,5\n//entre 11 et 12:59 ou 13 et inf 30\nelse if((heure >= 11 && heure <13) || (heure == 13 && minute <30 )){\n    msg.mode = 21.5;  \n    msg.tmp1 = \"de 11h00 à 13h30  => 21,5\";\n}\n//de 13h31 à 18h30  => 20\n//entre 14 et 17 ou 13 et sup = 30 ou 18 et inf 30\nelse if((heure > 13 && heure <18) || (heure == 13 && minute >=30 ) \n|| (heure == 18 && minute <30 )){\n    msg.mode = 21;    \n    msg.tmp1 = \"de 13h31 à 18h30  => 21\";\n}   \n//de 18h31 à 20   => 22\n//entre 19 et 19.59 ou 18 sup 30\nelse if((heure > 18 && heure <20) || (heure == 18 && minute >=30 )){\n    msg.mode = 22;    \n    msg.tmp1 = \"de 18h31 à 20   => 23\";\n}   \n//de 20h01 à 5h30 => 21\n//entre 20 et 4 ou 5 et inf 30\nelse if((heure >=20 && heure <= 23 ) || (heure >=0 && heure < 5) || (heure == 5 && minute <30 )){\n    msg.mode = 21;    \n    msg.tmp1 = \"de 20h01 à 5h30 => 21\";\n}   else {\n    msg.mode = 0;    \n    msg.tmp1 = \"non params\";\n}\nmsg.payload = msg.mode;\nreturn msg;\n\n\n\n\n","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":300,"y":80,"wires":[[]]},{"id":"536b9d32.f800d4","type":"inject","z":"af8edeeb.a0941","name":"","props":[{"p":"heure","v":"$number($moment().format(\"HH\"))","vt":"jsonata"},{"p":"minute","v":"$number($moment().format(\"mm\"))","vt":"jsonata"}],"repeat":"900","crontab":"","once":true,"onceDelay":0.1,"topic":"","payloadType":"str","x":110,"y":80,"wires":[["f626f489.87ba78"]]},{"id":"104225fc.f4e25a","type":"change","z":"af8edeeb.a0941","name":"","rules":[{"t":"set","p":"heure","pt":"msg","to":"$number($moment().format(\"HH\"))","tot":"jsonata"},{"t":"set","p":"minute","pt":"msg","to":"$number($moment().format(\"mm\"))","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":240,"y":20,"wires":[["f626f489.87ba78"]]},{"id":"3906ca75.3329e6","type":"tab","label":"Chauffage Parents","disabled":false,"info":""},{"id":"ee16b39.e3dd05","type":"server-state-changed","z":"3906ca75.3329e6","name":"Capteur ouverture","server":"d25c8042.050a3","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"binary_sensor.door_window_sensor_158d000309946a","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":480,"wires":[["2aa0f7eb.c6e658"]]},{"id":"2aa0f7eb.c6e658","type":"function","z":"3906ca75.3329e6","name":"","func":"//msg.topic=\"chauffage\"\n//msg.entity_id_temperature=msg.data.entity_id\n//msg.temperature=msg.data.state \nvar type = \"capteur_ouverture\";\nflow.set(type,msg.payload);\nflow.set(\"entity_id_\" + type,msg.data.entity_id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":480,"wires":[["b7a9eb23.bb54e8"]]},{"id":"724e7da3.12c4a4","type":"server-state-changed","z":"3906ca75.3329e6","name":"Sonde Temperature","server":"d25c8042.050a3","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"sensor.temperature_sa_t_ch_parents","entityidfiltertype":"exact","outputinitially":true,"state_type":"num","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":110,"y":540,"wires":[["4aed0d9.34f22f4"]]},{"id":"4aed0d9.34f22f4","type":"function","z":"3906ca75.3329e6","name":"","func":"//msg.topic=\"chauffage\"\n//msg.entity_id_ouverture=msg.data.entity_id\n//msg.capteur_ouverture=msg.data.state\nvar type = \"sonde_temperature\";\nflow.set(type,Number(msg.payload));\nflow.set(\"entity_id_\" + type,msg.data.entity_id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":280,"y":540,"wires":[["b7a9eb23.bb54e8","60ef23b2.f007fc"]]},{"id":"fcdcd87.7d9c628","type":"server-state-changed","z":"3906ca75.3329e6","name":"Radiateur","server":"d25c8042.050a3","version":3,"exposeToHomeAssistant":false,"haConfig":[{"property":"name","value":""},{"property":"icon","value":""}],"entityidfilter":"light.qubino_goap_zmnhjd1_flush_dimmer_pilot_wire_level","entityidfiltertype":"exact","outputinitially":true,"state_type":"str","haltifstate":"","halt_if_type":"str","halt_if_compare":"is","outputs":1,"output_only_on_state_change":true,"for":0,"forType":"num","forUnits":"minutes","ignorePrevStateNull":false,"ignorePrevStateUnknown":false,"ignorePrevStateUnavailable":false,"ignoreCurrentStateUnknown":false,"ignoreCurrentStateUnavailable":false,"outputProperties":[{"property":"payload","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"eventData"},{"property":"topic","propertyType":"msg","value":"","valueType":"triggerId"}],"x":80,"y":420,"wires":[["eb9f68d0.249148"]]},{"id":"eb9f68d0.249148","type":"function","z":"3906ca75.3329e6","name":"","func":"//msg.topic=\"chauffage\"\n//msg.entity_id_temperature=msg.data.entity_id\n//msg.temperature=msg.data.state\nvar type = \"radiateur\";\nflow.set(type,msg.payload);\nflow.set(\"entity_id_\" + type,msg.data.entity_id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":240,"y":420,"wires":[["849787cd.677a08"]]},{"id":"31035f96.8fe33","type":"ui_numeric","z":"3906ca75.3329e6","name":"","label":"Température cible","tooltip":"","group":"193d0b9.9d3f2f4","order":2,"width":0,"height":0,"wrap":false,"passthru":true,"topic":"chauffage","topicType":"str","format":"{{value}} °","min":"18","max":"25","step":"0.1","x":250,"y":640,"wires":[["656e167e.47aa98"]]},{"id":"8df6974e.fdc818","type":"function","z":"3906ca75.3329e6","name":"","func":"\nflow.set(\"temperature_ui\",msg.temperature_ui);\n//if(flow.get(\"relance\")!==undefined) {\n//} else {\n    flow.set(\"relance\",\"off\");\n    flow.set(\"timer\",\"on\");\n//}\n\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":640,"y":640,"wires":[["7194fb67.8feea4"]]},{"id":"b7a9eb23.bb54e8","type":"link out","z":"3906ca75.3329e6","name":"","links":["450fe51d.1b503c"],"x":415,"y":480,"wires":[]},{"id":"7194fb67.8feea4","type":"link out","z":"3906ca75.3329e6","name":"","links":["450fe51d.1b503c"],"x":755,"y":640,"wires":[]},{"id":"88c125e.84639d8","type":"comment","z":"3906ca75.3329e6","name":"Récupération des informations materiel","info":"","x":170,"y":380,"wires":[]},{"id":"dbb559e5.d960e8","type":"comment","z":"3906ca75.3329e6","name":"Affectation de la température cible","info":"","x":170,"y":600,"wires":[]},{"id":"4ad149f.fcdd3b8","type":"function","z":"3906ca75.3329e6","name":"","func":"var capteur_ouverture = flow.get(\"capteur_ouverture\");\nvar sonde_temperature = flow.get(\"sonde_temperature\");\nvar temperature_ui = flow.get(\"temperature_ui\");\nvar radiateur\t = flow.get(\"radiateur\");\nvar relance =  flow.get(\"relance\");\nvar timer_relance = 60000*15; // relance dans 15 min\nvar timer_chauffage = 60000*10; // 10min\n\nmsg.capteur_ouverture = capteur_ouverture;\nmsg.sonde_temperature = sonde_temperature;\nmsg.temperature_ui = temperature_ui;\nmsg.radiateur = radiateur;\nmsg.relance = relance;\nmsg.timer_relance = timer_relance;\nmsg.timer_chauffage = timer_chauffage;\n\n\nmsg.action=\"\";\nmsg.tmp=\"\";\nif(global.get(\"alarme\") == \"ON\"){\n    msg.tmp =\"ALARME ON TMP 18\";\n    flow.set(\"mode_auto\", false);\n    flow.set(\"temperature_ui\", 18);\n}else{\n    \n    if (msg.capteur_ouverture == 'off'){\n        //fenetre fermee\n        //msg.tmp = \"fenetre fermee\"; \n        \n        if (msg.temperature_ui <= msg.sonde_temperature){\n            msg.relance = \"off\";\n            if (msg.radiateur == 'on'){\n                msg.tmp = \"eteindre chauffage\";\n                msg.action = \"off\";\n                flow.set(\"timer\",\"off\");\n            }\n            else if (msg.radiateur == 'off'){\n                msg.tmp = \"radiateur déjà eteint\";\n                msg.action = \"NaN\";\n            }\n        }else if (msg.temperature_ui > msg.sonde_temperature){\n            if (msg.radiateur == 'on'){\n                //si la radiateur déjà allumî� je ne fais rien\n                msg.tmp = \"radiateur déjà allumé\";\n                msg.action = \"NaN\";\n            }else if (msg.radiateur == 'off'){\n                if(msg.relance == 'on'){\n                    //si relance prévu ne rien faire\n                    msg.tmp = \"relance active\";\n                    msg.action = \"NaN\";\n                }else if(msg.relance == 'off'){\n                    msg.tmp = \"allumage radiateur\";\n                    msg.action = \"on\";\n                }\n            }\n        }\n    } \n    else if (msg.capteur_ouverture == 'on'){\n        //fenetre ouverte\n        //if (radiateur == 'on'){\n             msg.tmp = \"fenetre ouverte\";\n             msg.action = \"off\";\n             msg.relance = \"off\";\n             flow.set(\"timer\",\"off\");\n        //}\n    }\n}\n\nflow.set('action',msg.action);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","libs":[],"x":580,"y":300,"wires":[["8df16d69.c3c84","5713a41d.46f1ac","25c6e8e2.123338"]]},{"id":"ad581164.7d5f4","type":"switch","z":"3906ca75.3329e6","name":"action","property":"action","propertyType":"msg","rules":[{"t":"eq","v":"on","vt":"str"},{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"NaN","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":1170,"y":380,"wires":[["10f30915.359b67"],["15dbcac.58ef135"],["66402487.97767c"]]},{"id":"71924f07.84984","type":"api-call-service","z":"3906ca75.3329e6","name":"","server":"d25c8042.050a3","version":3,"debugenabled":false,"service_domain":"light","service":"turn_on","entityId":"{{flow.entity_id_radiateur}}","data":"","dataType":"json","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1590,"y":260,"wires":[["5d8eb58f.3b808c"]]},{"id":"15dbcac.58ef135","type":"api-call-service","z":"3906ca75.3329e6","name":"","server":"d25c8042.050a3","version":3,"debugenabled":false,"service_domain":"light","service":"turn_off","entityId":"{{flow.entity_id_radiateur}}","data":"","dataType":"json","mergecontext":"","mustacheAltTags":false,"outputProperties":[],"queue":"none","x":1470,"y":440,"wires":[["499fed32.a41954"]]},{"id":"10f30915.359b67","type":"function","z":"3906ca75.3329e6","name":"3s","func":"msg.delay = 3000;\nmsg.textaffiche = \"ON\";\nvar m1 = {reset:true};\n\nreturn [[m1,msg]];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1370,"y":260,"wires":[["57c7609d.26ca5"]]},{"id":"57c7609d.26ca5","type":"delay","z":"3906ca75.3329e6","name":"","pauseType":"delayv","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1455,"y":260,"wires":[["71924f07.84984"]],"l":false},{"id":"1956be50.e0aca2","type":"function","z":"3906ca75.3329e6","name":"X min","func":"msg.delay = msg.timer_chauffage;\nvar m1 = {reset:true};\nmsg.etape = \"allumage \";\nreturn [[m1,msg]];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1830,"y":260,"wires":[["7c998604.6d0bf8","c14fe161.611bb"]]},{"id":"7c998604.6d0bf8","type":"delay","z":"3906ca75.3329e6","name":"","pauseType":"delayv","timeout":"2","timeoutUnits":"minutes","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1975,"y":260,"wires":[["60209809.581c68"]],"l":false},{"id":"e55c7dee.417d5","type":"link in","z":"3906ca75.3329e6","name":"","links":["60209809.581c68"],"x":1335,"y":360,"wires":[["15dbcac.58ef135"]]},{"id":"60209809.581c68","type":"link out","z":"3906ca75.3329e6","name":"","links":["e55c7dee.417d5"],"x":2035,"y":260,"wires":[]},{"id":"16a0ee2f.595e42","type":"function","z":"3906ca75.3329e6","name":"X min","func":"msg.delay = msg.timer_relance;\nvar m1 = {reset:true};\nflow.set(\"relance\",\"on\");\nreturn [[m1,msg]];","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1770,"y":380,"wires":[["5bfc505e.f007d"]]},{"id":"5bfc505e.f007d","type":"delay","z":"3906ca75.3329e6","name":"","pauseType":"delayv","timeout":"20","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1855,"y":380,"wires":[["cbe6bc36.7d1d5"]],"l":false},{"id":"f9399d68.d0d1a","type":"link out","z":"3906ca75.3329e6","name":"","links":["450fe51d.1b503c"],"x":2095,"y":420,"wires":[]},{"id":"450fe51d.1b503c","type":"link in","z":"3906ca75.3329e6","name":"START","links":["b7a9eb23.bb54e8","f9399d68.d0d1a","10193b4c.e6ad25","a18b9994.a6acb8","e2e5334b.ddd94","7194fb67.8feea4"],"x":390,"y":300,"wires":[["4ad149f.fcdd3b8"]],"l":true},{"id":"656e167e.47aa98","type":"change","z":"3906ca75.3329e6","name":"","rules":[{"t":"move","p":"payload","pt":"msg","to":"temperature_ui","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":375,"y":640,"wires":[["388f84af.a198dc"]],"l":false},{"id":"388f84af.a198dc","type":"switch","z":"3906ca75.3329e6","name":"","property":"temperature_ui","propertyType":"msg","rules":[{"t":"istype","v":"number","vt":"number"},{"t":"istype","v":"undefined","vt":"undefined"}],"checkall":"true","repair":false,"outputs":2,"x":435,"y":640,"wires":[["8df6974e.fdc818"],["12e98bac.209274"]],"l":false},{"id":"12e98bac.209274","type":"function","z":"3906ca75.3329e6","name":"","func":"msg.temperature_ui =20;\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":535,"y":660,"wires":[["8df6974e.fdc818"]],"l":false},{"id":"14b24aa4.fe1865","type":"inject","z":"3906ca75.3329e6","name":"","props":[],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payloadType":"str","x":90,"y":640,"wires":[["31035f96.8fe33"]]},{"id":"8df16d69.c3c84","type":"api-current-state","z":"3906ca75.3329e6","name":"Etat Radiateur","server":"d25c8042.050a3","version":2,"outputs":1,"halt_if":"","halt_if_type":"str","halt_if_compare":"is","entity_id":"{{flow.entity_id_radiateur}}","state_type":"str","blockInputOverrides":false,"outputProperties":[{"property":"payload_","propertyType":"msg","value":"","valueType":"entityState"},{"property":"data","propertyType":"msg","value":"","valueType":"entity"}],"x":780,"y":380,"wires":[["a1a9daae.b4a228"]]},{"id":"a1a9daae.b4a228","type":"function","z":"3906ca75.3329e6","name":"","func":"//msg.topic=\"chauffage\"\n//msg.entity_id_temperature=msg.data.entity_id\n//msg.temperature=msg.data.state\nvar type = \"radiateur\";\nflow.set(type,msg.payload_);\nflow.set(\"entity_id_\" + type,msg.data.entity_id);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":895,"y":380,"wires":[["debf74f8.20ee08"]],"l":false},{"id":"debf74f8.20ee08","type":"function","z":"3906ca75.3329e6","name":"param_relance","func":"//msg.topic=\"chauffage\"\n//msg.entity_id_temperature=msg.data.entity_id\n//msg.temperature=msg.data.state \nflow.set(\"tmp\",msg.tmp);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1020,"y":380,"wires":[["ad581164.7d5f4"]]},{"id":"cbe6bc36.7d1d5","type":"function","z":"3906ca75.3329e6","name":"Set Relance","func":"\nflow.set(\"relance\",\"off\");\n\nmsg.etape = \"relance auto  \";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1970,"y":380,"wires":[["f9399d68.d0d1a","c14fe161.611bb"]]},{"id":"499fed32.a41954","type":"switch","z":"3906ca75.3329e6","name":"timer","property":"timer","propertyType":"flow","rules":[{"t":"eq","v":"off","vt":"str"},{"t":"eq","v":"on","vt":"str"}],"checkall":"true","repair":false,"outputs":2,"x":1490,"y":380,"wires":[["2e3f7f64.479db"],["17dcc3f5.3042fc"]]},{"id":"9d883061.e6e71","type":"function","z":"3906ca75.3329e6","name":"Set Relance","func":"\nflow.set(\"relance\",\"off\");\n\nmsg.etape = \"relance off \";\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1790,"y":340,"wires":[["c14fe161.611bb"]]},{"id":"c14fe161.611bb","type":"function","z":"3906ca75.3329e6","name":"","func":"\nflow.set(\"message_telegram\",msg.etape + flow.get(\"tmp\"));\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":2160,"y":320,"wires":[[]]},{"id":"5d8eb58f.3b808c","type":"delay","z":"3906ca75.3329e6","name":"","pauseType":"delay","timeout":"1","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1735,"y":260,"wires":[["1956be50.e0aca2"]],"l":false},{"id":"2e3f7f64.479db","type":"delay","z":"3906ca75.3329e6","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1600,"y":320,"wires":[["9d883061.e6e71"]]},{"id":"17dcc3f5.3042fc","type":"delay","z":"3906ca75.3329e6","name":"","pauseType":"delay","timeout":"5","timeoutUnits":"seconds","rate":"1","nbRateUnits":"1","rateUnits":"second","randomFirst":"1","randomLast":"5","randomUnits":"seconds","drop":false,"x":1720,"y":460,"wires":[["16a0ee2f.595e42"]]},{"id":"60ef23b2.f007fc","type":"ui_text","z":"3906ca75.3329e6","group":"193d0b9.9d3f2f4","order":3,"width":0,"height":0,"name":"Température piece","label":"Température piece","format":"{{msg.payload}}","layout":"row-spread","x":490,"y":540,"wires":[]},{"id":"53587e7c.4d159","type":"ui_switch","z":"3906ca75.3329e6","name":"","label":"Radiateur","tooltip":"","group":"193d0b9.9d3f2f4","order":10,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"bouton","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":560,"y":420,"wires":[[]]},{"id":"849787cd.677a08","type":"function","z":"3906ca75.3329e6","name":"","func":"if(msg.payload == 'on'){\n    msg.payload = true;\n}else if(msg.payload == 'off'){\n    msg.payload = false;\n}\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":400,"y":420,"wires":[["53587e7c.4d159"]]},{"id":"66402487.97767c","type":"function","z":"3906ca75.3329e6","name":"","func":"\nflow.set(\"message_telegram\",\"\");\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":1340,"y":520,"wires":[[]]},{"id":"5713a41d.46f1ac","type":"ui_text","z":"3906ca75.3329e6","group":"193d0b9.9d3f2f4","order":4,"width":0,"height":0,"name":"Action","label":"Action","format":"{{msg.action}}","layout":"row-spread","x":750,"y":260,"wires":[]},{"id":"25c6e8e2.123338","type":"ui_text","z":"3906ca75.3329e6","group":"193d0b9.9d3f2f4","order":5,"width":0,"height":0,"name":"infos","label":"Action","format":"{{msg.tmp}}","layout":"row-spread","x":750,"y":300,"wires":[]},{"id":"64865bfc.79fed4","type":"subflow:af8edeeb.a0941","z":"3906ca75.3329e6","name":"","env":[],"x":90,"y":760,"wires":[["5421cdef.142f74"]]},{"id":"86b46cd6.221fd","type":"ui_switch","z":"3906ca75.3329e6","name":"","label":"Mode auto","tooltip":"","group":"193d0b9.9d3f2f4","order":1,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"true","onvalueType":"bool","onicon":"","oncolor":"","offvalue":"false","offvalueType":"bool","officon":"","offcolor":"","x":279,"y":836,"wires":[["678924c.3d1b0dc"]]},{"id":"a56d268f.195408","type":"inject","z":"3906ca75.3329e6","name":"","props":[{"p":"payload"}],"repeat":"","crontab":"","once":true,"onceDelay":0.1,"topic":"","payload":"true","payloadType":"bool","x":88,"y":836,"wires":[["86b46cd6.221fd"]]},{"id":"678924c.3d1b0dc","type":"function","z":"3906ca75.3329e6","name":"","func":"flow.set(\"mode_auto\",msg.payload);\nreturn msg;","outputs":1,"noerr":0,"initialize":"","finalize":"","x":459,"y":836,"wires":[["31035f96.8fe33"]]},{"id":"5421cdef.142f74","type":"switch","z":"3906ca75.3329e6","name":"","property":"mode_auto","propertyType":"flow","rules":[{"t":"true"},{"t":"false"}],"checkall":"true","repair":false,"outputs":2,"x":270,"y":760,"wires":[["31035f96.8fe33","84b538e.8b96fc8"],[]]},{"id":"84b538e.8b96fc8","type":"ui_text","z":"3906ca75.3329e6","group":"193d0b9.9d3f2f4","order":3,"width":0,"height":0,"name":"Mode infos","label":"Mode infos","format":"{{msg.tmp1}}","layout":"row-spread","x":640,"y":722,"wires":[]},{"id":"d25c8042.050a3","type":"server","name":"Home Assistant","version":1,"addon":true,"rejectUnauthorizedCerts":true,"ha_boolean":"y|yes|true|on|home|open","connectionDelay":true,"cacheJson":true},{"id":"193d0b9.9d3f2f4","type":"ui_group","name":"Parents","tab":"920a4349.95e21","order":2,"disp":true,"width":"6","collapse":false},{"id":"920a4349.95e21","type":"ui_tab","name":"Home","icon":"dashboard","disabled":false,"hidden":false}]
